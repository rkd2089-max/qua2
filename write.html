<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>질문 작성 - Q&A 게시판</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>Q&A 게시판</h1>
    </div>
  </header>

  <div class="container">
    <div class="form-container">
      <h2 style="margin-bottom: 20px; color: #2c3e50;">질문 작성</h2>
      
      <form id="questionForm" onsubmit="submitQuestion(event)">
        <div class="form-group">
          <label for="nickname">닉네임 *</label>
          <input type="text" id="nickname" required placeholder="닉네임을 입력하세요">
        </div>
        
        <div class="form-group">
          <label for="category">카테고리 *</label>
          <select id="category" required>
            <option value="">선택하세요</option>
            <option value="자유">자유</option>
            <option value="개발">개발</option>
            <option value="질문">질문</option>
            <option value="기타">기타</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="title">제목 *</label>
          <input type="text" id="title" required placeholder="질문 제목을 입력하세요">
        </div>
        
        <div class="form-group">
          <label for="content">내용 *</label>
          <textarea id="content" required placeholder="질문 내용을 입력하세요"></textarea>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="location.href='index.html'">취소</button>
          <button type="submit" class="btn btn-primary">등록</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  
  <!-- 설정 및 스크립트 -->
  <script src="firebase-config.js"></script>
  <script src="script.js"></script>
  <script>
    async function submitQuestion(event) {
      event.preventDefault();
      
      const nickname = document.getElementById('nickname').value.trim();
      const category = document.getElementById('category').value;
      const title = document.getElementById('title').value.trim();
      const content = document.getElementById('content').value.trim();
      
      // 유효성 검사
      if (!nickname || !category || !title || !content) {
        alert('모든 필드를 입력해주세요.');
        return;
      }
      
      try {
        await db.collection('questions').add({
          nickname: nickname,
          category: category,
          title: title,
          content: content,
          viewCount: 0,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        alert('질문이 등록되었습니다.');
        location.href = 'index.html';
      } catch (error) {
        console.error('질문 등록 실패:', error);
        alert('질문 등록 중 오류가 발생했습니다.');
      }
    }
  </script>
</body>
</html>
